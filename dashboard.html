<!doctype html>

<html>

<head>
	<title>PR Quality - Dashboard MVP</title>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
	<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

	<style type="text/css">
		body {
			background-color: #243746;
			color: #ffb259;
			padding: 50px;
		}

		.metric-widget {
			overflow: hidden;
		}

		.metric-widget__title {
			background-color: #ffb259;
			color: #243746;
			margin-bottom: 2px;
		}

		.metric-widget__chart {
			width: 100%; 
		}

		.metric-widget__chart > div > div {
			margin: 0 auto;
		}
	</style>

		<script type="text/javascript">
		var rawData = {
		"12": [
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/147",
			"prn": 147,
			"created_at": "2020-12-22 13:31:13 UTC",
			"closed_at": "2021-02-12 14:23:22 UTC",
			"number_of_commits": 1,
			"number_of_files": 1,
			"number_of_reviewers": 3,
			"number_of_comments": 6,
			"avg_commit_message_word_count": 50,
			"total_lines_added": 20,
			"total_lines_deleted": 1,
			"total_lines_changed": 21,
			"pr_message_word_count": 47
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/146",
			"prn": 146,
			"created_at": "2020-12-22 12:57:36 UTC",
			"closed_at": "2020-12-29 12:04:03 UTC",
			"number_of_commits": 1,
			"number_of_files": 4,
			"number_of_reviewers": 3,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 36,
			"total_lines_added": 23,
			"total_lines_deleted": 25,
			"total_lines_changed": 48,
			"pr_message_word_count": 57
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/144",
			"prn": 144,
			"created_at": "2020-12-16 16:47:03 UTC",
			"closed_at": "2020-12-18 12:45:00 UTC",
			"number_of_commits": 1,
			"number_of_files": 4,
			"number_of_reviewers": 3,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 37,
			"total_lines_added": 4,
			"total_lines_deleted": 4,
			"total_lines_changed": 8,
			"pr_message_word_count": 56
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/143",
			"prn": 143,
			"created_at": "2020-12-04 12:14:34 UTC",
			"closed_at": "2021-02-05 16:05:51 UTC",
			"number_of_commits": 1,
			"number_of_files": 1,
			"number_of_reviewers": 3,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 71,
			"total_lines_added": 32,
			"total_lines_deleted": 0,
			"total_lines_changed": 32,
			"pr_message_word_count": 65
			}
		],
		"10": [
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/142",
			"prn": 142,
			"created_at": "2020-10-30 09:55:50 UTC",
			"closed_at": "2020-10-30 10:34:17 UTC",
			"number_of_commits": 1,
			"number_of_files": 2,
			"number_of_reviewers": 3,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 28,
			"total_lines_added": 5,
			"total_lines_deleted": 2,
			"total_lines_changed": 7,
			"pr_message_word_count": 54
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/141",
			"prn": 141,
			"created_at": "2020-10-26 16:22:25 UTC",
			"closed_at": "2020-10-30 10:20:11 UTC",
			"number_of_commits": 1,
			"number_of_files": 1,
			"number_of_reviewers": 4,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 69,
			"total_lines_added": 6,
			"total_lines_deleted": 1,
			"total_lines_changed": 7,
			"pr_message_word_count": 60
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/137",
			"prn": 137,
			"created_at": "2020-10-09 10:41:38 UTC",
			"closed_at": "2020-10-20 11:10:19 UTC",
			"number_of_commits": 2,
			"number_of_files": 9,
			"number_of_reviewers": 4,
			"number_of_comments": 8,
			"avg_commit_message_word_count": 95,
			"total_lines_added": 57,
			"total_lines_deleted": 0,
			"total_lines_changed": 57,
			"pr_message_word_count": 57
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/136",
			"prn": 136,
			"created_at": "2020-10-08 14:28:41 UTC",
			"closed_at": "2020-10-09 10:21:53 UTC",
			"number_of_commits": 4,
			"number_of_files": 9,
			"number_of_reviewers": 0,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 47,
			"total_lines_added": 63,
			"total_lines_deleted": 2,
			"total_lines_changed": 65,
			"pr_message_word_count": 155
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/132",
			"prn": 132,
			"created_at": "2020-10-06 10:37:38 UTC",
			"closed_at": "2020-10-09 09:55:18 UTC",
			"number_of_commits": 1,
			"number_of_files": 8,
			"number_of_reviewers": 3,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 22,
			"total_lines_added": 48,
			"total_lines_deleted": 54,
			"total_lines_changed": 102,
			"pr_message_word_count": 14
			}
		],
		"08": [
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/117",
			"prn": 117,
			"created_at": "2020-08-25 12:37:06 UTC",
			"closed_at": "2020-10-30 10:16:45 UTC",
			"number_of_commits": 1,
			"number_of_files": 2,
			"number_of_reviewers": 0,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 37,
			"total_lines_added": 2,
			"total_lines_deleted": 0,
			"total_lines_changed": 2,
			"pr_message_word_count": 24
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/113",
			"prn": 113,
			"created_at": "2020-08-19 09:03:04 UTC",
			"closed_at": "2020-10-30 10:15:19 UTC",
			"number_of_commits": 10,
			"number_of_files": 51,
			"number_of_reviewers": 3,
			"number_of_comments": 4,
			"avg_commit_message_word_count": 19,
			"total_lines_added": 1476,
			"total_lines_deleted": 247,
			"total_lines_changed": 1723,
			"pr_message_word_count": 60
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/110",
			"prn": 110,
			"created_at": "2020-08-17 16:48:28 UTC",
			"closed_at": "2020-08-19 09:49:55 UTC",
			"number_of_commits": 1,
			"number_of_files": 2,
			"number_of_reviewers": 1,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 98,
			"total_lines_added": 4,
			"total_lines_deleted": 8,
			"total_lines_changed": 12,
			"pr_message_word_count": 99
			},
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/107",
			"prn": 107,
			"created_at": "2020-08-17 09:39:38 UTC",
			"closed_at": "2020-08-19 10:18:50 UTC",
			"number_of_commits": 1,
			"number_of_files": 1,
			"number_of_reviewers": 1,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 69,
			"total_lines_added": 1,
			"total_lines_deleted": 1,
			"total_lines_changed": 2,
			"pr_message_word_count": 68
			}
		],
		"05": [
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/90",
			"prn": 90,
			"created_at": "2020-05-29 17:15:09 UTC",
			"closed_at": "2020-05-29 17:21:57 UTC",
			"number_of_commits": 1,
			"number_of_files": 1,
			"number_of_reviewers": 0,
			"number_of_comments": 0,
			"avg_commit_message_word_count": 13,
			"total_lines_added": 55,
			"total_lines_deleted": 55,
			"total_lines_changed": 110,
			"pr_message_word_count": 14
			}
		],
		"04": [
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/83",
			"prn": 83,
			"created_at": "2020-04-03 11:16:06 UTC",
			"closed_at": "2020-06-24 15:10:33 UTC",
			"number_of_commits": 1,
			"number_of_files": 5,
			"number_of_reviewers": 3,
			"number_of_comments": 3,
			"avg_commit_message_word_count": 6,
			"total_lines_added": 39,
			"total_lines_deleted": 0,
			"total_lines_changed": 39,
			"pr_message_word_count": 13
			}
		],
		"03": [
			{
			"url": "https://api.github.com/repos/dxw/rails-template/pulls/81",
			"prn": 81,
			"created_at": "2020-03-06 16:27:24 UTC",
			"closed_at": "2020-04-03 11:39:45 UTC",
			"number_of_commits": 3,
			"number_of_files": 3,
			"number_of_reviewers": 3,
			"number_of_comments": 3,
			"avg_commit_message_word_count": 13,
			"total_lines_added": 18,
			"total_lines_deleted": 6,
			"total_lines_changed": 24,
			"pr_message_word_count": 59
			}
		]
		}

		var chartData = {};

		// Parse the raw data into a workable dataset.
		for (var month in rawData) {

			if ( Object.hasOwnProperty.call(rawData, month) ) {
				var prCollection = rawData[month];
				
				for (let i = 0; i < prCollection.length; i++) {
					var prData = prCollection[i];
					
					for (var k in prData) {
						if (Object.hasOwnProperty.call(prData, k)) {
							var prValue = prData[k];
							var flag = false;
							
							if ( ! chartData.hasOwnProperty( k ) ) {
								chartData[k] = [];
							}

							for (let i = 0; i < chartData[k].length; i++) {
								const monthArr = chartData[k][i];

								if ( monthArr[0] == month ) {
									flag = true;
									monthArr[1].push( prValue );
								}
							}

							if ( ! flag ) {
								chartData[k].push( [ month, [ prValue ] ] );
							}
						}
					}
				}
			}
		}

		for (var key in chartData) {
			if (Object.hasOwnProperty.call(chartData, key)) {
				var months = chartData[key];
				
				for (var i = 0; i < months.length; i++) {
					var element = months[i];

					var total = 0;
					for (var x in element[1]) {
						total += element[1][x];
					}

					element[1] = parseInt( total / element[1].length );
				}
			}
		}

		// Generate the chart 
		var chartStats = chartData;

		var chartOptions = {
			width: 500,
			height: 380,
			backgroundColor: '#f9fafb',
			legend: 'none',
			hAxis: {
				title: 'Month of the Year (2020)',
        	},
        	vAxis: {
          		title: 'Average Number'
        	},
			colors:['#09615d']
		};

		google.charts.load('current', {'packages':['corechart']});

		// @TODO Make this dynamic!
		google.charts.setOnLoadCallback(drawMetricOne);
		google.charts.setOnLoadCallback(drawMetricTwo);
		google.charts.setOnLoadCallback(drawMetricThree);
		google.charts.setOnLoadCallback(drawMetricFour);
		google.charts.setOnLoadCallback(drawMetricFive);
		google.charts.setOnLoadCallback(drawMetricSix);
		google.charts.setOnLoadCallback(drawMetricSeven);
		google.charts.setOnLoadCallback(drawMetricEight);
		google.charts.setOnLoadCallback(drawMetricNine);

		// # METRIC ONE
		function drawMetricOne() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
      		data.addColumn('number', 'Average Number');
			data.addRows( chartStats.number_of_commits );

			var chart = new google.visualization.ColumnChart(document.getElementById('number_of_commits'));

			chart.draw(data, chartOptions);
		}

		// # METRIC TWO
		function drawMetricTwo() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
      		data.addColumn('number', 'Average Number');
			data.addRows( chartStats.number_of_files );

			var chart = new google.visualization.ColumnChart(document.getElementById('number_of_files'));

			chart.draw(data, chartOptions);
		}

		// # METRIC THREE
		function drawMetricThree() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
      		data.addColumn('number', 'Average Number');
			data.addRows( chartStats.number_of_reviewers );

			var chart = new google.visualization.ColumnChart(document.getElementById('number_of_reviewers'));

			chart.draw(data, chartOptions);
		}

		// # METRIC FOUR
		function drawMetricFour() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
      		data.addColumn('number', 'Average Number');
			data.addRows( chartStats.number_of_comments );

			var chart = new google.visualization.ColumnChart(document.getElementById('number_of_comments'));

			chart.draw(data, chartOptions);
		}

		// # METRIC FIVE
		function drawMetricFive() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
      		data.addColumn('number', 'Average Number');
			data.addRows( chartStats.avg_commit_message_word_count );

			var chart = new google.visualization.ColumnChart(document.getElementById('avg_commit_message_word_count'));

			chart.draw(data, chartOptions);
		}

		// # METRIC SIX
		function drawMetricSix() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
      		data.addColumn('number', 'Average Number');
			data.addRows( chartStats.total_lines_changed );

			var chart = new google.visualization.ColumnChart(document.getElementById('total_lines_changed'));

			chart.draw(data, chartOptions);
		}

		// # METRIC SEVEN
		function drawMetricSeven() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
			data.addColumn('number', 'Average Number');
			data.addRows( chartStats.pr_message_word_count );

			var chart = new google.visualization.ColumnChart(document.getElementById('pr_message_word_count'));

			chart.draw(data, chartOptions);
		}


		// # METRIC EIGHT
		function drawMetricEight() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
			data.addColumn('number', 'Average Number');
			data.addRows( chartStats.total_lines_added );

			var chart = new google.visualization.ColumnChart(document.getElementById('total_lines_added'));

			chart.draw(data, chartOptions);
		}

		// # METRIC NINE
		function drawMetricNine() {

			var data = new google.visualization.DataTable();

			data.addColumn('string', 'Month in 2020');
			data.addColumn('number', 'Average Number');
			data.addRows( chartStats.total_lines_deleted );

			var chart = new google.visualization.ColumnChart(document.getElementById('total_lines_deleted'));

			chart.draw(data, chartOptions);
		}
	</script>

</head>

<body>

	<h1 class="text-4xl font-bold text-center mb-10">PR Quality - Dashboard MVP</h1>

	<div class="flex flex-wrap -mx-3 overflow-hidden">

		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">
			
			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Number of Commits</h2>

				<div id="number_of_commits" class="metric-widget__chart bg-gray-50"></div>

			</div>
			
		</div>
		
		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">

			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Number of Files Changed</h2>

				<div id="number_of_files" class="metric-widget__chart bg-gray-50"></div>

			</div>

		</div>
		
		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">

			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Number of Reviewers</h2>

				<div id="number_of_reviewers" class="metric-widget__chart bg-gray-50"></div>

			</div>

		</div>
		
		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">

			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Comments</h2>

				<div id="number_of_comments" class="metric-widget__chart bg-gray-50"></div>

			</div>

		</div>
		
		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">

			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Commit Word Count</h2>

				<div id="avg_commit_message_word_count" class="metric-widget__chart bg-gray-50"></div>

			</div>

		</div>
		
		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">

			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Body Word Count</h2>

				<div id="pr_message_word_count" class="metric-widget__chart bg-gray-50"></div>

			</div>

		</div>

		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">

			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Total Lines Changed</h2>

				<div id="total_lines_changed" class="metric-widget__chart bg-gray-50"></div>

			</div>

		</div>

		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">

			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Total Lines Added</h2>

				<div id="total_lines_added" class="metric-widget__chart bg-gray-50"></div>

			</div>

		</div>

		<div class="my-3 px-3 w-full overflow-hidden md:w-1/2 lg:w-1/3">

			<div class="metric-widget">

				<h2 class="metric-widget__title p-3 text-xl font-semibold text-center">Average Total Lines Deleted</h2>

				<div id="total_lines_deleted" class="metric-widget__chart bg-gray-50"></div>

			</div>

		</div>
		
	</div>

</body>

</html>